<section class="add-view-order">
    <div class="my-4">
        <div class="row">
            <div class="col-md-10">
                <div class="p-4">
                    <form [formGroup]="orderForm">
                        <div class="row align-items-center">
                            <div class="col-md-6">
                                <div class="title mb-2">
                                    <span>{{'welcome' | translate}}</span>
                                    <h3 class="fs-3">
                                        {{ 'orders.editOrder' | translate }}
                                    </h3>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <!-- Date -->
                            <div class="col-md-4">
                                <mat-form-field appearance="fill" class="example-full-width">
                                    <mat-label class="text-orange">{{'orders.date' | translate}}</mat-label>
                                    <input formControlName="start_date" matInput [matDatepicker]="picker3">
                                    <mat-hint>MM/DD/YYYY</mat-hint>
                                    <mat-datepicker-toggle matIconSuffix [for]="picker3"></mat-datepicker-toggle>
                                    <mat-datepicker #picker3></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <!--  Department -->
                            <div class="col-md-4">
                                <mat-form-field class="w-100" [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange">{{'orders.department' | translate}}</mat-label>

                                    <input formControlName="department_id" matInput
                                        placeholder="{{'orders.department' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!--  Engineer -->
                            <div class="col-md-4">
                                <mat-form-field class="w-100" [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange">{{'orders.engineer' | translate}}</mat-label>
                                    <input formControlName="engineer_id" matInput
                                        placeholder="{{'orders.engineer' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!--  Technician -->
                            <div class="col-md-4">
                                <mat-form-field class="w-100" [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange">{{'orders.technician' | translate}}</mat-label>
                                    <input formControlName="technician_id" matInput
                                        placeholder="{{'orders.technician' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!-- Work Type -->
                            <div class="col-md-4">
                                <mat-form-field class="w-100" [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange">{{'orders.workType' | translate}}</mat-label>
                                    <input formControlName="work_type_id" matInput
                                        placeholder="{{'orders.workType' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!-- Building -->
                            <div class="col-md-4">
                                <mat-form-field class="w-100" [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange">{{'orders.building' | translate}}</mat-label>
                                    <input formControlName="building_id" matInput
                                        placeholder="{{'orders.building' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!-- Floor no -->
                            <div class="col-md-4">
                                <mat-form-field appearance="fill" class="w-100"
                                    [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange"> {{'orders.floor' | translate}}</mat-label>
                                    <input formControlName="floor_no" matInput
                                        placeholder="{{'orders.floor' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!-- Room no -->
                            <div class="col-md-4">
                                <mat-form-field appearance="fill" class="w-100"
                                    [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange">{{'orders.room' | translate}}</mat-label>
                                    <input formControlName="room_no" matInput
                                        placeholder="{{'orders.room' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!-- Customer name -->
                            <div class="col-md-4">
                                <mat-form-field appearance="fill" class="w-100"
                                    [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange"> {{'orders.requestername'| translate}}</mat-label>
                                    <input formControlName="customer_name" matInput
                                        placeholder=" {{'orders.requestername'| translate}}" />
                                </mat-form-field>
                            </div>
                            <!-- Customer Phone -->
                            <div class="col-md-4">
                                <mat-form-field appearance="fill" class="w-100"
                                    [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange"> {{'orders.mobile'| translate}}</mat-label>
                                    <input formControlName="customer_phone" matInput
                                        placeholder=" {{'orders.mobile'| translate}}" />
                                    <mat-error *ngIf="orderForm.controls.customer_phone.hasError('required')">
                                        {{'orders.mobile'| translate}} {{'required' | translate}}
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <!-- Equipment -->
                            <div class="col-md-4">
                                <mat-form-field class="w-100" [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange">{{'orders.equipment'| translate}}</mat-label>
                                    <input formControlName="equipment_id" matInput
                                        placeholder="{{'orders.equipment' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!-- Source -->
                            <div class="col-md-4">
                                <mat-form-field class="w-100" [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label class="text-orange">{{'orders.source'| translate}}</mat-label>
                                    <input formControlName="source_id" matInput
                                        placeholder="{{'orders.source' | translate}}" />
                                </mat-form-field>
                            </div>
                            <!-- Description -->
                            <div class="row">
                                <div class="col-md-8">
                                    <mat-form-field class="example-full-width">
                                        <mat-label class="text-orange">{{'orders.description'|translate}}</mat-label>
                                        <textarea formControlName="description" matInput
                                            placeholder="Ex. It makes me feel..."></textarea>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                    </form>
                    <!-- strat Add material -->
                    <h1>{{'orders.update.material' | translate}}</h1>
                    <table class="custom-table">
                        <thead class="text-capitalize">
                            <th class="alone">{{'orders.update.name' | translate}}</th>
                            <th class="alone">{{'orders.update.description' | translate}}</th>
                            <th class="alone">{{'orders.update.quantity' | translate}}</th>
                            <th class="alone">{{'orders.actions' | translate}}</th>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of materialTableData; let isEven = even"
                                [class]="isEven ? '' : 'bg-secondary-subtle'">
                                <td>{{ item.name }}</td>
                                <td>{{ item.description }}</td>
                                <td>{{ item.quantity }}</td>
                                <td class="text-center">
                                    <button mat-icon-button [matMenuTriggerFor]="menu"
                                        aria-label="Example icon-button with a menu">
                                        <mat-icon>more_vert</mat-icon>
                                    </button>
                                    <mat-menu #menu="matMenu">
                                        <button [routerLink]="['view-order', item.id]" mat-menu-item>
                                            <mat-icon>visibility</mat-icon>
                                            <span>{{'users.view' | translate}}</span>
                                        </button>
                                        <button [routerLink]="['edit-order',item.id]" mat-menu-item>
                                            <mat-icon>edit_square</mat-icon>
                                            <span>{{'edit'|translate}}</span>
                                        </button>
                                        <button mat-menu-item >
                                            <mat-icon>delete</mat-icon>
                                            <span>{{'delete'|translate}}</span>
                                        </button>
                                    </mat-menu>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <!-- <div class="text-center d-flex justify-content-end">
                        <button 
                            class="primary text-center w-25">{{'addnew'|translate}}</button>
                    </div> -->

                    <!-- Start Spare Parts -->
                    <h1>{{'orders.update.parts' | translate}}</h1>
                    <table class="custom-table">
                        <thead class="text-capitalize">
                            <th class="alone">{{'orders.update.name' | translate}}</th>
                            <th class="alone">{{'orders.update.description' | translate}}</th>
                            <th class="alone">{{'orders.update.quantity' | translate}}</th>
                            <th class="alone">{{'orders.actions' | translate}}</th>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of spareTableData; let isEven = even"
                                [class]="isEven ? '' : 'bg-secondary-subtle'">
                                <td>{{ item.name }}</td>
                                <td>{{ item.description }}</td>
                                <td>{{ item.quantity }}</td>
                                <td class="text-center">
                                    <button mat-icon-button [matMenuTriggerFor]="menu"
                                        aria-label="Example icon-button with a menu">
                                        <mat-icon>more_vert</mat-icon>
                                    </button>
                                    <mat-menu #menu="matMenu">
                                        <button [routerLink]="['view-order', item.id]" mat-menu-item>
                                            <mat-icon>visibility</mat-icon>
                                            <span>{{'users.view' | translate}}</span>
                                        </button>
                                        <button [routerLink]="['edit-order',item.id]" mat-menu-item>
                                            <mat-icon>edit_square</mat-icon>
                                            <span>{{'edit'|translate}}</span>
                                        </button>
                                        <button mat-menu-item >
                                            <mat-icon>delete</mat-icon>
                                            <span>{{'delete'|translate}}</span>
                                        </button>
                                    </mat-menu>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <!-- <div class="text-center d-flex justify-content-end">
                        <button 
                            class="primary text-center w-25">{{'addnew'|translate}}</button>
                    </div> -->

                    <!--  Status Form -->
                    <form [formGroup]="updateOrderForm" (ngSubmit)="onupdate(updateOrderForm)" >
                        <div class="row">
                            <div class="col-md-4">
                                <mat-form-field class="w-100" [hideRequiredMarker]="hideRequiredMarker">
                                    <mat-label>{{'orders.status' | translate}}</mat-label>
                                    <mat-select [(value)]="statusId" (selectionChange)="onselectStatus(updateOrderForm)"
                                        formControlName="status">
                                        <mat-option *ngFor="let item of status" [value]="item.id">
                                            {{item.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <!-- Holding Reason -->
                        <div *ngIf="isHold==true" class="col-md-4">
                            <mat-form-field class="example-full-width" appearance="fill" class="w-100"
                                [hideRequiredMarker]="hideRequiredMarker">
                                <mat-label class="text-orange"> {{'orders.holding_reason' | translate}}</mat-label>
                                <input formControlName="holding_reason" matInput
                                    placeholder="{{'orders.holding_reason' | translate}}" />
                            </mat-form-field>
                        </div>
                        </div>

                        <!-- Technical Report -->
                        <div class="row">
                            <div class="col-md-8">
                                <mat-form-field class="example-full-width">
                                    <mat-label>{{'orders.tech_report'|translate}}</mat-label>
                                    <textarea formControlName="technician_report" matInput
                                        placeholder="Ex. It makes me feel..."></textarea>
                                        <!-- <mat-error *ngIf="updateOrderForm.controls.technician_report.hasError('required')">
                                            {{'orders.tech_report' | translate}} {{'required' | translate}}
                                        </mat-error> -->
                                </mat-form-field>
                            </div>
                        </div>
                        

                        <!-- Update button for Order -->
                        <div class="text-center mt-3 d-flex justify-content-between">
                            <button type="button" class="outline-secondary w-25"
                                routerLink="/dashboard/engineer/work-orders">{{'cancel'|translate}}</button>
                            <button [disabled]="updateOrderForm.invalid" class="primary text-center w-25">{{'save'|translate}}</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>